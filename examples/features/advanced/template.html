<!DOCTYPE html>
<html>
<head>
    <title>Advanced Features</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; background: #f9f9f9; }
        .example { background: white; padding: 10px; margin: 10px 0; border-left: 3px solid #28a745; }
        code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; }
        pre { background: #272822; color: #f8f8f2; padding: 15px; overflow-x: auto; }
        .output { color: #007bff; font-weight: bold; }
        .whitespace-demo { border: 1px solid #ccc; background: #ffe; padding: 10px; }
        .char { border: 1px dotted #999; }
    </style>
</head>
<body>
    <h1>Advanced Features Showcase</h1>

    <!-- Example 1: Filter Blocks -->
    <div class="section">
        <h2>1. Filter Blocks</h2>

        <div class="example">
            <h3>Single Filter:</h3>
            <p>Output:</p>
            <div class="output">
{% filter upper %}
This entire block will be uppercase
Including {{ name }} variable
{% endfilter %}
            </div>
        </div>

        <div class="example">
            <h3>Chained Filters:</h3>
            <p>Output:</p>
            <div class="output">
{% filter trim|upper|replace("WORLD", "MIYA") %}
   hello world
{% endfilter %}
            </div>
        </div>

        <div class="example">
            <h3>Filter Block with Logic:</h3>
            <p>Output:</p>
            <div class="output">
{% filter upper %}
User list:
{% for user in users %}
- {{ user.name }}
{% endfor %}
{% endfilter %}
            </div>
        </div>

        <div class="example">
            <h3>Filter Block with Title Case:</h3>
            <div class="output">
{% filter title %}
this is an important announcement.
please read carefully.
{% endfilter %}
            </div>
        </div>

        <div class="example">
            <h3>Nested Filter Blocks:</h3>
            <div class="output">
{% filter upper %}
Outer block
{% filter trim %}
  inner block
{% endfilter %}
End outer
{% endfilter %}
            </div>
        </div>
    </div>

    <!-- Example 2: Do Statements -->
    <div class="section">
        <h2>2. Do Statements</h2>

        <div class="example">
            <h3>Execute Without Output:</h3>
            {% set calculation_result = 0 %}
            {% do numbers|sum %}
            <p>Calculation performed silently (no output from do statement)</p>
        </div>

        <div class="example">
            <h3>Do with Side Effects:</h3>
            <p>Used for operations that modify state without producing output</p>
        </div>

        <div class="example">
            <h3>Do with Filters:</h3>
            {% do (100 * 5)|round %}
            <p>Expression evaluated, result not displayed</p>
        </div>
    </div>

    <!-- Example 3: Whitespace Control -->
    <div class="section">
        <h2>3. Whitespace Control</h2>

        <div class="example">
            <h3>Without Whitespace Control:</h3>
            <div class="whitespace-demo">
<pre>{% for item in items %}
{{ item }}
{% endfor %}</pre>
            </div>
        </div>

        <div class="example">
            <h3>With Left Whitespace Control (-):</h3>
            <div class="whitespace-demo">
<pre>{%- for item in items %}
{{ item }}
{% endfor %}</pre>
            </div>
        </div>

        <div class="example">
            <h3>With Right Whitespace Control:</h3>
            <div class="whitespace-demo">
<pre>{% for item in items -%}
{{ item }}
{% endfor %}</pre>
            </div>
        </div>

        <div class="example">
            <h3>Both Sides Control:</h3>
            <div class="whitespace-demo">
<pre>{%- for item in items -%}
{{- item -}}
{%- endfor -%}</pre>
            </div>
        </div>

        <div class="example">
            <h3>Practical Example - Clean List:</h3>
            <code>Items: </code>
{%- for item in items -%}
{{ item }}{% if not loop.last %}, {% endif %}
{%- endfor %}
        </div>

        <div class="example">
            <h3>Whitespace in Variables:</h3>
            Values:
            {%- for num in numbers -%}
                {{- num -}}
                {%- if not loop.last -%},{%- endif -%}
            {%- endfor %}
        </div>
    </div>

    <!-- Example 4: Raw Blocks -->
    <div class="section">
        <h2>4. Raw Blocks (Escaping Template Syntax)</h2>

        <div class="example">
            <h3>Raw Block Example:</h3>
            <p>Raw blocks allow template syntax to be treated as literal text without processing</p>
        </div>

        <div class="example">
            <h3>Documentation Example:</h3>
            <p>Raw blocks are useful for displaying template syntax in documentation</p>
        </div>
    </div>

    <!-- Example 5: Autoescape Control -->
    <div class="section">
        <h2>5. Autoescape Control</h2>

        <div class="example">
            <h3>Default (Autoescape ON):</h3>
            <p>{{ html_snippet }}</p>
        </div>

        <div class="example">
            <h3>Autoescape OFF:</h3>
            {% autoescape false %}
            <p>{{ html_snippet }}</p>
            {% endautoescape %}
        </div>

        <div class="example">
            <h3>Autoescape ON (explicit):</h3>
            {% autoescape true %}
            <p>{{ dangerous_html }}</p>
            {% endautoescape %}
        </div>

        <div class="example">
            <h3>Using |safe Filter:</h3>
            <p>{{ html_snippet|safe }}</p>
        </div>

        <div class="example">
            <h3>Using |escape Filter:</h3>
            <p>{{ html_snippet|escape }}</p>
        </div>
    </div>

    <!-- Example 6: Complex Combinations -->
    <div class="section">
        <h2>6. Combining Advanced Features</h2>

        <div class="example">
            <h3>Filter Block + Whitespace Control:</h3>
            <div class="output">
{%- filter upper|trim -%}
   combined features
{%- endfilter -%}
            </div>
        </div>

        <div class="example">
            <h3>Filter Block with Variables:</h3>
            <div class="output">
{% filter title %}
{{ name }} is using miya engine
{% endfilter %}
            </div>
        </div>

        <div class="example">
            <h3>Whitespace + Conditionals:</h3>
            <div class="whitespace-demo">
{%- if users|length > 0 -%}
Users: {{ users|length }}
{%- else -%}
No users
{%- endif -%}
            </div>
        </div>
    </div>

    <!-- Example 7: Performance Features -->
    <div class="section">
        <h2>7. Environment Configuration</h2>

        <div class="example">
            <h3>Available Options:</h3>
            <ul>
                <li><strong>AutoEscape:</strong> Automatic HTML escaping (default: true)</li>
                <li><strong>StrictUndefined:</strong> Error on undefined variables (default: false)</li>
                <li><strong>TrimBlocks:</strong> Remove first newline after block (default: false)</li>
                <li><strong>LstripBlocks:</strong> Strip leading whitespace before blocks (default: false)</li>
            </ul>
        </div>

        <div class="example">
            <h3>Go Configuration Example:</h3>
            <pre><code>env := miya.NewEnvironment(
    miya.WithAutoEscape(true),
    miya.WithStrictUndefined(true),
    miya.WithTrimBlocks(true),
    miya.WithLstripBlocks(true),
)</code></pre>
        </div>
    </div>

    <!-- Summary Table -->
    <div class="section">
        <h2>8. Advanced Features Summary</h2>
        <table border="1" cellpadding="10" style="width: 100%; border-collapse: collapse;">
            <tr>
                <th>Feature</th>
                <th>Syntax</th>
                <th>Purpose</th>
                <th>Status</th>
            </tr>
            <tr>
                <td>Filter Blocks</td>
                <td><code>filter blocks</code></td>
                <td>Apply filters to entire blocks</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Do Statements</td>
                <td><code>do statements</code></td>
                <td>Execute without output</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Whitespace Control</td>
                <td><code>Whitespace trim syntax</code></td>
                <td>Control output whitespace</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Raw Blocks</td>
                <td><code>raw blocks</code></td>
                <td>Escape template syntax</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Autoescape</td>
                <td><code>autoescape blocks</code></td>
                <td>Control HTML escaping</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Filter Chaining</td>
                <td><code>chained filters</code></td>
                <td>Multiple filters on blocks</td>
                <td>✅</td>
            </tr>
            <tr>
                <td>Nested Filters</td>
                <td>Nested filter blocks</td>
                <td>Hierarchical filtering</td>
                <td>✅</td>
            </tr>
        </table>
    </div>

    <footer>
        <p>All advanced features are 100% Jinja2 compatible</p>
        <p>Generated with Miya Engine</p>
    </footer>
</body>
</html>
